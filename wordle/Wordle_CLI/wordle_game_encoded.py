import base64
exec(base64.b64decode("aW1wb3J0IHJhbmRvbQoKZGVmIGNob29zZV93b3JkKCk6CiAgICB3aXRoIG9wZW4oImZpdmVfbGV0dGVyX3dvcmRzLnR4dCIsICJyIikgYXMgZmlsZToKICAgICAgICB3b3JkcyA9IGZpbGUucmVhZCgpLnNwbGl0bGluZXMoKQogICAgcmV0dXJuIHJhbmRvbS5jaG9pY2Uod29yZHMpLCB3b3JkcwogICAgCmRlZiBjaGVja19ndWVzcyh3b3JkLCBndWVzcyk6CiAgICBsID0gW10KICAgIGZvciBpIGluIHJhbmdlKGxlbihndWVzcykpOgogICAgICAgIGlmIHdvcmRbMF0gPT0gZ3Vlc3NbaV06CiAgICAgICAgICAgIGwuYXBwZW5kKCdncmVlbicpCiAgICAgICAgZWxpZiBndWVzc1tpXSBpbiB3b3JkOgogICAgICAgICAgICBsLmFwcGVuZCgneWVsbG93JykKICAgICAgICBlbHNlOgogICAgICAgICAgICBsLmFwcGVuZCgnYmxhY2snKQogICAgICAgIHdvcmQgPSB3b3JkWzE6XQogICAgcmV0dXJuIFsoZ3Vlc3NbaV0sIGxbaV0pIGZvciBpIGluIHJhbmdlKGxlbihsKSldCgpkZWYgcGFyc2UoY2hlY2tfcmVzdWx0KToKICAgIHJlcyA9ICBsZW4oJ0d1ZXNzIGEgNSBMZXR0ZXIgV29yZDogJykqJyAnCiAgICBmb3IgcmVzdWx0IGluIGNoZWNrX3Jlc3VsdDoKICAgICAgICBpZiByZXN1bHRbMV0gPT0gJ2JsYWNrJzoKICAgICAgICAgICAgcmVzID0gcmVzICsgKCLirJsiKQogICAgICAgIGVsaWYgcmVzdWx0WzFdID09ICd5ZWxsb3cnOgogICAgICAgICAgICByZXMgPSByZXMgKyAoIvCfn6giKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJlcyA9IHJlcyArICgi8J+fqSIpCiAgICByZXR1cm4gcmVzCgojIyMgQ0xJICMjIwpkZWYgcGxheSgpOgogICAgcmVtYWluaW5nX2d1ZXNzZXMgPSA2CiAgICB3b3JkLCB3b3JkcyA9IGNob29zZV93b3JkKCkKICAgIHdoaWxlIHJlbWFpbmluZ19ndWVzc2VzID4gMDoKICAgICAgICBndWVzc19pc19ub3RfdmFsaWQgPSBUcnVlCiAgICAgICAgd2hpbGUgZ3Vlc3NfaXNfbm90X3ZhbGlkOgogICAgICAgICAgICBndWVzcyA9IGlucHV0KCJHdWVzcyBhIDUgTGV0dGVyIFdvcmQ6ICIpCiAgICAgICAgICAgIGlmIGxlbihndWVzcykgIT0gNToKICAgICAgICAgICAgICAgIHByaW50KCJOb3QgNSBMZXR0ZXJzIikKICAgICAgICAgICAgZWxpZiBub3QgKGd1ZXNzIGluIHdvcmRzKToKICAgICAgICAgICAgICAgIHByaW50KCJOb3QgYSBWYWxpZCBXb3JkIikKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGd1ZXNzX2lzX25vdF92YWxpZCA9IEZhbHNlCiAgICAgICAgICAgICAgICByZW1haW5pbmdfZ3Vlc3NlcyA9IHJlbWFpbmluZ19ndWVzc2VzIC0gMQogICAgICAgIGNoZWNrX3Jlc3VsdCA9IGNoZWNrX2d1ZXNzKHdvcmQsIGd1ZXNzKQogICAgICAgIHByaW50KHBhcnNlKGNoZWNrX3Jlc3VsdCkpCiAgICAgICAgaWYgYWxsKFtjaGVja19yZXN1bHRbaV1bMV0gPT0gJ2dyZWVuJyBmb3IgaSBpbiByYW5nZShsZW4oY2hlY2tfcmVzdWx0KSldKToKICAgICAgICAgICAgcHJpbnQoIkNvbmdyYXRzISIpCiAgICAgICAgICAgIHJldHVybgogICAgcHJpbnQoZiJPdXQgb2YgZ3Vlc3NlcywgdGhlIGNvcnJlY3Qgd29yZCB3YXMge3dvcmR9IikKCnBsYXkoKQ==").decode())
